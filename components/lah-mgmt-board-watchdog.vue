<template lang="pug">
b-card
  template(#header)
    .d-flex.align-items-center
      h6.mb-0.mt-1.mr-1 #[lah-fa-icon(icon="screwdriver-wrench", size="lg", variant="info") å¿«é€Ÿæª¢æ¸¬ï¼†ä¿®æ­£]
      b-button-group.ml-auto(size="sm"): lah-button(
        icon="question",
        action="breath",
        variant="outline-success",
        no-border,
        no-icon-gutter,
        @click="$refs.help.show()",
        title="å¿«é€Ÿæª¢æ¸¬åŠä¿®æ­£èªªæ˜"
      )
    lah-help-modal(ref="help", modal-title="å¿«é€Ÿæª¢æ¸¬åŠä¿®æ­£èªªæ˜", size="lg")
      h5 æœ¬é …åŠŸèƒ½æä¾›ä¸‹åˆ—6é …æª¢æ¸¬/æŸ¥è©¢åŠŸèƒ½ã€‚
      ul
        li æœ€æ–°æ¬Šç‹€åºè™Ÿ (MOICAT.RXSEQ)
          ul
            li é¡¯ç¤ºæœ€æ–°æ¬Šç‹€åºè™ŸåŠæ¡ˆä»¶è™Ÿ
        li ç™»è¨˜æ¡ˆä»¶è·¨æ‰€è¨»è¨˜å•é¡Œæª¢æ¸¬ (CRSMS)
          ol
            li RM99 = 'Y'
            li RM100 = 'è³‡æ–™ç®¡è½„æ‰€ä»£ç¢¼'
            li RM100_1 = 'è³‡æ–™ç®¡è½„æ‰€ç¸£å¸‚ä»£ç¢¼'
            li RM101 = 'æ”¶ä»¶æ‰€ä»£ç¢¼'
            li RM101_1 = 'æ”¶ä»¶æ‰€ç¸£å¸‚ä»£ç¢¼'
        li åœ°åƒ¹æ¡ˆä»¶è·¨æ‰€è¨»è¨˜å•é¡Œæª¢æ¸¬ (PSCRN)
          ol
            li SS99 = 'Y'
            li SS100 = 'è³‡æ–™ç®¡è½„æ‰€ä»£ç¢¼'
            li SS100_1 = 'è³‡æ–™ç®¡è½„æ‰€ç¸£å¸‚ä»£ç¢¼'
            li SS101 = 'æ”¶ä»¶æ‰€ä»£ç¢¼'
            li SS101_1 = 'æ”¶ä»¶æ‰€ç¸£å¸‚ä»£ç¢¼'
        li æ‚ éŠå¡ä»˜æ¬¾å•é¡Œæª¢æ¸¬
          ol
            li æ«ƒå°ä¾†é›»é€šçŸ¥æ‚ éŠå¡æ‰£æ¬¾æˆåŠŸä½†åœ°æ”¿ç³»çµ±å»é¡¯ç¤ºæ‰£æ¬¾å¤±æ•—ï¼Œéœ€è·Ÿæ«ƒå°è¦ã€é›»è…¦çµ¦è™Ÿã€‘
            li ç®¡ç†å¸«è™•ç†æ–¹æ³•ï¼šAA106ç‚º'2' OR '8'å°‡AA106æ›´æ­£ç‚º'1'å³å¯ã€AA01:äº‹ç™¼æ—¥æœŸã€AA04:é›»è…¦çµ¦è™Ÿã€‘ã€‚
            li èªæ³•åƒè€ƒï¼šUPDATE MOIEXP.EXPAA SET AA106 = '1' WHERE AA01='1070720' AND AA04='0043405'
        li æ¸¬é‡æ¡ˆä»¶é€£ä»¶å•é¡Œæª¢æ¸¬
          ol
            li â€»æ³¨æ„ï¼šæœ¬åŠŸèƒ½æœƒæ¸…é™¤å•é¡Œæ¬„ä½è³‡æ–™ä¸¦å°‡æ¡ˆä»¶è¾¦ç†æƒ…å½¢æ”¹ç‚ºã€æ ¸å®šã€‘ï¼Œè«‹ç¢ºèªå¾Œå†åŸ·è¡Œã€‚
            li åŸå› æ˜¯ CMB0301 å»¶æœŸè¤‡ä¸ˆåŠŸèƒ½ï¼Œé‡å°æ–¼æœ‰é€£ä»¶æ¡ˆä»¶åœ¨åšè™•ç†æ™‚ï¼Œæœƒè‡ªå‹•æ ¹æ“šMM24æ¡ˆä»¶æ•¸ï¼Œå°‡å¾Œé¢çš„æ¡ˆä»¶è‡ªå‹•åšå»¶æœŸè¤‡ä¸ˆçš„æ›´æ–°ã€‚å°è‡´å¾ŒçºŒå·²çµæ¡ˆçš„æ¡ˆä»¶æœƒè¢«æ”¹æˆå»¶æœŸè¤‡ä¸ˆçš„ç‹€æ…‹ MM22='C' å°±æ˜¯ 100ã€200ã€300ã€400ç‚ºå››é€£ä»¶ï¼Œæ‰€ä»¥100çš„æ¡ˆä»¶ MM24='4'ï¼Œ200ã€300ã€400 çš„ MM24='0' å»¶æœŸè¤‡ä¸ˆçš„å•é¡Œå†å°‡100è™Ÿåšå»¶æœŸè¤‡ä¸ˆçš„æ™‚å€™ï¼Œæœƒå°‡200ã€300ã€400ä¹Ÿåšå»¶æœŸè¤‡ä¸ˆçš„æ›´æ–°ï¼Œæ‰€ä»¥å¦‚æœ400å·²ç¶“çµæ¡ˆï¼Œ100åšå»¶æœŸè¤‡ä¸ˆï¼Œé‚£400è™Ÿå°±æœƒè®Šæˆ MM22='C' MM23='A' MM24='4' çš„ç•°å¸¸ç‹€æ…‹ã€‚
        li æ¸¬é‡æ¡ˆä»¶é€šçŸ¥æ›¸æš«å­˜æª”æŸ¥è©¢
          ol
            li æ¸¬é‡èª²å¸¸æœ‰é€šçŸ¥æ›¸ç„¡æ³•ç”¢è£½å‡ºå•é¡Œï¼Œç¶“æŸ¥ç‹€æ³ç‚º CMCRD è¡¨æ ¼ä¸­å­˜æœ‰#[strong.text-primary ç©ºç™½å…§å®¹]æˆ–æ˜¯#[strong.text-primary æ²’æœ‰æ¡ˆä»¶é€£çµ]çš„æš«å­˜æª”å½±éŸ¿æµæ°´è™Ÿç”³è«‹ã€‚
            li æœ¬åŠŸèƒ½æä¾›æŸ¥è©¢å¾Œåˆ—å‡ºç³»çµ±ç›®å‰æš«å­˜æª”ä»¥ä¾›ç®¡ç†å¸«æŸ¥çœ‹åŠç®¡ç†ã€‚
  //- .center-container-wh-100: div
  .d-flex.align-items-center.justify-content-between.check-row
    lah-fa-icon.mr-1(icon="magnifying-glass") ã€Œç™»è¨˜æ¡ˆä»¶ã€è·¨æ‰€è¨»è¨˜
    lah-button(
      title="æª¢æ¸¬ç™»è¨˜æ¡ˆä»¶è·¨æ‰€è¨»è¨˜éºå¤±å•é¡Œ",
      @click="checkRegXcase",
      no-icon-gutter
    ) æª¢æ¸¬
  hr
  .d-flex.align-items-center.justify-content-between.check-row
    lah-fa-icon.mr-1(icon="dollar-sign") ã€Œåœ°åƒ¹æ¡ˆä»¶ã€è·¨æ‰€è¨»è¨˜
    lah-button(
      title="æª¢æ¸¬åœ°åƒ¹æ¡ˆä»¶è·¨æ‰€è¨»è¨˜éºå¤±å•é¡Œ",
      @click="checkValXcase",
      no-icon-gutter
    ) æª¢æ¸¬
  hr
  .d-flex.align-items-center.justify-content-between.check-row
    lah-fa-icon.mr-1(icon="credit-card") è¦è²»æ‚ éŠå¡ä»˜æ¬¾å•é¡Œ
    lah-button(
      title="æª¢æ¸¬æ‚ éŠå¡ä»˜æ¬¾å¤±æ•—å•é¡Œ(ä¸€å‘¨å…§)",
      @click="checkEzPayment"
    ) æª¢æ¸¬
  hr
  .d-flex.align-items-center.justify-content-between.check-row
    lah-fa-icon.mr-1(icon="location-dot") æ¸¬é‡é€£ä»¶å•é¡Œæ¡ˆä»¶
    lah-button(
      title="æ¸¬é‡å•é¡Œæ¡ˆä»¶æª¢æ¸¬",
      @click="checkSurCase"
    ) æª¢æ¸¬
  hr
  .d-flex.align-items-center.justify-content-between.check-row
    lah-fa-icon.mr-1(icon="file-circle-exclamation") æ¸¬é‡è¤‡ä¸ˆé€šçŸ¥æ›¸æš«å­˜æª”
    lah-button(
      :title="`æŸ¥è©¢æ‰€æœ‰ ${year} å¹´é€šçŸ¥æ›¸æš«å­˜è³‡æ–™`",
      @click="showSurCmcrdTmpModal"
    ) æŸ¥è©¢
  hr
  //- .d-flex.align-items-center.justify-content-between.check-row
  //-   lah-fa-icon.mr-1(icon="file") æœ€æ–°æ¬Šç‹€åºè™Ÿ
  //-   lah-badge-latest-certno(@fetched="handledUpdated")
  //- hr
  .d-flex.align-items-center.justify-content-between.check-row(title="è¼¸å…¥æ‰‹æ©Ÿæˆ–EMAILæŸ¥è©¢")
    lah-fa-icon.text-nowrap(
      icon="comment-sms"
    ) ç°¡è¨ŠæŸ¥è©¢
    b-input.mx-1(
      v-model="smsKeyword",
      size="sm",
      placeholder="... æ‰‹æ©Ÿæˆ–EMAIL ...",
      @keyup.enter="querySMS"
    )
    lah-button(
      title="ä¾æ¢ä»¶æŸ¥è©¢SMSç´€éŒ„",
      @click="querySMS",
      :disabled="!validSMSKeyword"
    ) æŸ¥è©¢
  hr

  lah-message(:message="message", auto-hide, close-variant="danger")

  lah-transition(appear): b-card(v-if="foundRegCases")
    h5: lah-fa-icon(icon="triangle-exclamation", variant="warning") æ‰¾åˆ°ä¸‹åˆ—è·¨æ‰€è¨»è¨˜éºå¤±æ¡ˆä»¶(ç™»è¨˜)
    b-list-group(flush)
      b-list-group-item(
        v-for="(item, index) in regCases",
        :key="`reg_case_${index}`",
        href="#",
        @click="detail(item)"
      )
        .d-flex.align-items-center.justify-content-between
          lah-fa-icon(icon="circle-exclamation", variant="danger") {{ $utils.caseId(item) }}
          lah-button(icon="hammer", action="tick", variant="outline-primary", @click="fixRegCase(item)") ä¿®æ­£

  lah-transition(appear): b-card(v-if="foundValCases")
    h5: lah-fa-icon(icon="triangle-exclamation", variant="warning") æ‰¾åˆ°ä¸‹åˆ—è·¨æ‰€è¨»è¨˜éºå¤±æ¡ˆä»¶(åœ°åƒ¹)
    b-list-group(flush)
      b-list-group-item(
        v-for="(item, index) in valCases",
        :key="`val_case_${index}`",
        href="#",
        @click="detail(item)"
      )
        .d-flex.align-items-center.justify-content-between
          lah-fa-icon(icon="circle-exclamation", variant="danger") {{ $utils.caseId(item) }}
          lah-button(icon="hammer", action="tick", variant="outline-info", @click="fixValCase(item)") ä¿®æ­£

  lah-transition(appear): b-card(v-if="foundPaymentData")
    h5: lah-fa-icon(icon="triangle-exclamation", variant="warning") æ‰¾åˆ°ä¸‹åˆ—æ‚ éŠå¡ä»˜æ¬¾å¤±æ•—å•é¡Œ
    b-list-group(flush)
      b-list-group-item(
        v-for="(item, index) in paymentData"
        :key="`payment_${index}`"
      )
        | æ—¥æœŸ: {{ item["AA01"] }}, é›»è…¦çµ¦è™Ÿ: {{ item["AA04"] }}, å¯¦æ”¶é‡‘é¡: {{ item["AA28"] }}
        b-badge(v-if="!$utils.empty(item['AA104'])", variant="danger") , ä½œå»¢åŸå› : {{ item["AA104"] }}
        | , ç›®å‰ç‹€æ…‹: {{paymentStatus(item["AA106"]) }}
        lah-button(v-if="$utils.empty(item['AA104'])", @click="paymentFix(item)", variant="outline-dark") ä¿®æ­£

  lah-transition(appear): b-card(v-if="foundSurCases")
    h5: lah-fa-icon(icon="triangle-exclamation", variant="warning") æ‰¾åˆ°ä¸‹åˆ—æœ‰å•é¡Œä¹‹æ¸¬é‡æ¡ˆä»¶
    b-list-group(flush)
      b-list-group-item(
        v-for="(id, index) in surCases",
        :key="`val_case_${id}`"
      )
        .d-flex.align-items-center.justify-content-between
          lah-fa-icon(icon="circle-exclamation", variant="danger") {{ $utils.caseId(id) }}
          lah-button(icon="hammer", action="tick", variant="outline-secondary", @click="fixSurCase(id)") ä¿®æ­£

  //- template(#footer)
  //-   .d-flex.justify-content-between
  //-     lah-fa-icon(icon="dog", size="lg", variant="secondary")
  //-     lah-fa-icon(icon="paw", size="lg", variant="secondary")
</template>

<script>
import lahAdmSmslogTableVue from '~/components/lah-adm-smslog-table.vue'
import lahMgmtBoardCmcrdCheckVue from '~/components/lah-mgmt-board-cmcrd-check.vue'
import lahRegCaseDetailVue from './lah-reg-case-detail.vue'
export default {
  components: { lahRegCaseDetailVue, lahAdmSmslogTableVue, lahMgmtBoardCmcrdCheckVue },
  data: () => ({
    // regCases: ['105HAB1016151', '105HAB1016150'],
    // valCases: ['105HAB1016130', '105HAB1016090'],
    // surCases: ['105HA52035400']
    regCases: [],
    valCases: [],
    surCases: [],
    paymentData: [],
    smsLogs: [],
    message: '',
    clearTimer: null,
    year: '',
    smsKeyword: ''
  }),
  computed: {
    foundRegCases () {
      return this.regCases?.length > 0
    },
    foundValCases () {
      return this.valCases?.length > 0
    },
    foundPaymentData () {
      return this.paymentData?.length > 0
    },
    foundSurCases () {
      return this.surCases?.length > 0
    },
    validSMSKeyword () {
      return this.smsKeyword?.length > 1
    }
  },
  watch: {},
  created () {
    // default is this TW year
    const now = new Date()
    this.year = now.getFullYear() - 1911
    this.smsKeyword = this.$utils.today('TW')
  },
  mounted () {},
  methods: {
    beforeFetch () {
      this.isBusy = true
      this.message = `${this.$utils.time()} æŸ¥è©¢ä¸­ ...`
      this.regCases = []
      this.valCases = []
      this.surCases = []
      this.paymentData = []
    },
    detail (caseId) {
      this.modal(this.$createElement(lahRegCaseDetailVue, {
        props: { caseId }
      }), {
        title: `ç™»è¨˜æ¡ˆä»¶è©³æƒ… ${this.$utils.caseId(caseId)}`,
        size: 'xl'
      })
    },
    checkXcase (type) {
      this.beforeFetch()
      this.$axios.post(this.$consts.API.JSON.QUERY, {
        type
      }).then((res) => {
        const caseType = type.startsWith('val') ? 'åœ°åƒ¹' : 'ç™»è¨˜'
        const prefix = `æª¢æ¸¬ã€Œ${caseType}æ¡ˆä»¶ã€è·¨æ‰€è¨»è¨˜å•é¡Œ`
        if (this.$utils.statusCheck(res.data.status)) {
          if (type === 'xcase-check') {
            this.regCases = res.data.case_ids
          } else if (type === 'val-xcase-check') {
            this.valCases = res.data.case_ids
          }
        } else if (res.data.status === this.$consts.XHR_STATUS_CODE.DEFAULT_FAIL) {
          this.message = `${this.$utils.time()} ğŸŸ¢ ${prefix}ï¼Œç›®å‰ä¸€åˆ‡æ­£å¸¸`
          // this.success('ğŸŸ¢ ç›®å‰ä¸€åˆ‡æ­£å¸¸', {
          //   title: 'æª¢æ¸¬æ¡ˆä»¶è·¨æ‰€è¨»è¨˜å•é¡Œ'
          // })
        } else {
          this.message = `${this.$utils.time()} ğŸ”´${prefix}ï¼Œ${res.data.messag}`
          // this.alert(res.data.message, { title: 'æª¢æ¸¬æ¡ˆä»¶è·¨æ‰€è¨»è¨˜å•é¡Œ' })
        }
      }).catch((err) => {
        this.$utils.error(err)
      }).finally(() => {
        this.isBusy = false
      })
    },
    checkValXcase () {
      this.checkXcase('val-xcase-check')
    },
    checkRegXcase () {
      this.checkXcase('xcase-check')
    },
    fixCase (type, id, callback) {
      this.isBusy = true
      this.$axios.post(this.$consts.API.JSON.QUERY, {
        type,
        id
      }).then((res) => {
        const caseType = type.endsWith('val') ? 'åœ°åƒ¹' : 'ç™»è¨˜'
        const prefix = `ä¿®æ­£ã€Œ${caseType}æ¡ˆä»¶ã€è·¨æ‰€è¨»è¨˜`
        if (this.$utils.statusCheck(res.data.status)) {
          this.message = `${this.$utils.time()} ğŸŸ¢ ${prefix} ${this.$utils.caseId(id)} æˆåŠŸ`
          // this.success(`${this.$utils.caseId(id)} å·²ä¿®æ­£è·¨æ‰€è¨»è¨˜ã€‚`, {
          //   title: 'è·¨æ‰€è¨»è¨˜éºå¤±æ¡ˆä»¶ä¿®æ­£ç‹€æ…‹',
          //   subtitle: this.$utils.caseId(id)
          // })
          callback && callback()
        } else {
          this.message = `${this.$utils.time()} ğŸŸ¡ ${prefix} ${this.$utils.caseId(id)} å¤±æ•—`
          // this.warning(`${this.$utils.caseId(id)} è·¨æ‰€è¨»è¨˜ä¿®æ­£å¤±æ•—ï¼(${res.data.status})`, {
          //   title: 'è·¨æ‰€è¨»è¨˜éºå¤±æ¡ˆä»¶ä¿®æ­£ç‹€æ…‹',
          //   subtitle: this.$utils.caseId(id)
          // })
        }
      }).catch((err) => {
        this.$utils.error(err)
      }).finally(() => {
        this.isBusy = false
      })
    },
    fixRegCase (caseId) {
      this.fixCase('fix_xcase', caseId, () => {
        this.regCases = this.regCases.filter(item => item !== caseId)
      })
    },
    fixValCase (caseId) {
      this.fixCase('fix_xcase_val', caseId, () => {
        this.valCases = this.valCases.filter(item => item !== caseId)
      })
    },
    checkEzPayment () {
      this.beforeFetch()
      this.$axios.post(this.$consts.API.JSON.QUERY, {
        type: 'ez-payment-check',
        qday: ''
      }).then((res) => {
        if (this.$utils.statusCheck(res.data.status)) {
          this.paymentData = res.data.raw
        } else {
          this.message = `${this.$utils.time()} ğŸŸ¢ æª¢æ¸¬æ‚ éŠå¡ä»˜æ¬¾å•é¡Œï¼š${res.data.message}`
          // this.success(res.data.message, { title: 'æª¢æ¸¬æ‚ éŠå¡ä»˜æ¬¾å•é¡Œ' })
        }
      }).catch((err) => {
        this.$utils.error(err)
      }).finally(() => {
        this.isBusy = false
      })
    },
    paymentStatus (AA106) {
      let status = 'æœªçŸ¥çš„ç‹€æ…‹ç¢¼ã€' + AA106 + 'ã€‘'
      /*
          1ï¼šæ‰£æ¬¾æˆåŠŸ
          2ï¼šæ‰£æ¬¾å¤±æ•—
          3ï¼šå–æ¶ˆæ‰£æ¬¾
          8ï¼šæ‰£æ¬¾ç•°å¸¸äº¤æ˜“
          9ï¼šå–æ¶ˆæ‰£æ¬¾ç•°å¸¸äº¤æ˜“
      */
      switch (AA106) {
        case '1':
          status = 'æ‰£æ¬¾æˆåŠŸ'
          break
        case '2':
          status = 'æ‰£æ¬¾å¤±æ•—'
          break
        case '3':
          status = 'å–æ¶ˆæ‰£æ¬¾'
          break
        case '8':
          status = 'æ‰£æ¬¾ç•°å¸¸äº¤æ˜“'
          break
        case '9':
          status = 'å–æ¶ˆæ‰£æ¬¾ç•°å¸¸äº¤æ˜“'
          break
        default:
          break
      }
      return status
    },
    paymentFix (item) {
      const qday = item.AA01
      const pcNumber = item.AA04
      const amount = item.AA28
      const message = 'ç¢ºå®šè¦ä¿®æ­£ æ—¥æœŸ: ' + qday + ', é›»è…¦çµ¦è™Ÿ: ' + pcNumber + ', é‡‘é¡: ' + amount + ' æ‚ éŠå¡ä»˜æ¬¾è³‡æ–™?'
      this.confirm(message).then((YN) => {
        if (YN) {
          this.isBusy = true
          this.$axios.post(this.$consts.API.JSON.QUERY, {
            type: 'fix_easycard',
            qday,
            pc_num: pcNumber
          }).then((res) => {
            if (this.$utils.statusCheck(res.data.status)) {
              this.message = `${this.$utils.time()} ğŸŸ¢ ä¿®æ­£ï¼šæ—¥æœŸ: ${qday}, é›»è…¦çµ¦è™Ÿ: ${pcNumber} æˆåŠŸ`
              // this.success('ä¿®æ­£ æ—¥æœŸ: ' + qday + ', é›»è…¦çµ¦è™Ÿ: ' + pcNumber + ' æˆåŠŸ', { title: 'æ‚ éŠå¡ä»˜æ¬¾å¤±æ•—ä¿®æ­£' })
              this.paymentData = this.paymentData.filter(item => !(item.AA01 === qday && item.AA04 === pcNumber))
            } else {
              this.message = `${this.$utils.time()} ğŸ”´ ä¿®æ­£å¤±æ•—ï¼š${res.data.message}`
              // this.alert(res.data.message, { title: 'æ‚ éŠå¡ä»˜æ¬¾å¤±æ•—ä¿®æ­£' })
            }
          }).catch((err) => {
            this.error = err
          }).finally(() => {
            this.isBusy = false
          })
        }
      })
    },
    checkSurCase () {
      this.beforeFetch()
      this.$axios.post(this.$consts.API.JSON.QUERY, {
        type: 'sur-problem-check'
      }).then((res) => {
        if (this.$utils.statusCheck(res.data.status)) {
          this.surCases = res.data.ids
        } else {
          this.message = `${this.$utils.time()} ğŸŸ¢ ${res.data.message}`
          // this.success(res.data.message, { title: 'æª¢æ¸¬æ¸¬é‡å•é¡Œæ¡ˆä»¶' })
        }
      }).catch((err) => {
        this.$utils.error(err)
      }).finally(() => {
        this.isBusy = false
      })
    },
    fixSurCase (id) {
      const message = `ç¢ºå®šè¦ä¿®æ­£æœ¬æ¡ˆä»¶ ${this.$utils.caseId(id)} ?<p class="pt-3"><i class="fa fa-exclamation-circle text-danger"></i> å°‡ä¿®æ­£ä¸‹åˆ—æ¬„ä½ï¼š</p>1.è¾¦ç†æƒ…å½¢æ”¹ç‚ºæ ¸å®š<br/>2.æ¸…é™¤å»¶æœŸæ™‚é–“<br/>3.é€£ä»¶æ•¸è¨­ç‚º1<br/><br/>è«‹ç¢ºèªå†è¡Œä¿®æ­£ã€‚`
      this.confirm(message, { html: true }).then((YN) => {
        if (YN) {
          this.isBusy = true
          this.$axios.post(this.$consts.API.JSON.QUERY, {
            type: 'fix_sur_delay_case',
            id,
            UPD_MM22: true,
            CLR_DELAY: true,
            FIX_COUNT: true
          }).then((res) => {
            if (this.$utils.statusCheck(res.data.status)) {
              this.message = `${this.$utils.time()} ğŸŸ¢ ${this.$utils.caseId(id)} æ¡ˆä»¶ä¿®æ­£æˆåŠŸï¼`
              // this.success(`${this.$utils.caseId(id)} æ¡ˆä»¶ä¿®æ­£æˆåŠŸï¼`, {
              //   title: 'ä¿®æ­£è¤‡ä¸ˆæ¡ˆä»¶',
              //   subtitle: id
              // })
              this.surCases = this.surCases.filter(item => item !== id)
            } else {
              const msg = 'å›å‚³ç‹€æ…‹ç¢¼ä¸æ­£ç¢º!ã€' + res.data.message + 'ã€‘'
              this.message = `${this.$utils.time()} ğŸŸ¡ ä¿®æ­£è¤‡ä¸ˆæ¡ˆä»¶å¤±æ•—ï¼š${msg} (${id})`
              // this.alert(msg, {
              //   title: 'ä¿®æ­£è¤‡ä¸ˆæ¡ˆä»¶å¤±æ•—',
              //   subtitle: id
              // })
            }
          }).catch((err) => {
            this.$utils.error(err)
          }).finally(() => {
            this.isBusy = false
          })
        }
      })
    },
    showSurCmcrdTmpModal () {
      this.modal(this.$createElement(lahMgmtBoardCmcrdCheckVue, {
        props: {
          embed: false
        }
      }), {
        title: 'è¤‡ä¸ˆé€šçŸ¥æ›¸æš«å­˜æª”åˆ—è¡¨',
        size: 'lg'
      })
    },
    querySMS () {
      this.modal(this.$createElement(lahAdmSmslogTableVue, {
        props: {
          inKeyword: this.smsKeyword
        }
      }), {
        title: 'åœ°æ”¿ç³»çµ±ç°¡è¨Šç¶œåˆè¨˜éŒ„æª”æŸ¥è©¢',
        size: 'xl',
        noCloseOnBackdrop: true,
        centered: false,
        scrollable: false
      })
    },
    handledUpdated (response) {
      this.message = `${this.$utils.time()} ${response.message}`
    }
  }
}
</script>

<style lang="scss" scoped>
.check-row {
  &:hover {
    background-color: rgb(226, 248, 225);
    // padding: 5px;
    border-radius: 10px;
  }
}
</style>
